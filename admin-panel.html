<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پنل مدیریت - دکان آنلاین</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #f5f7fa;
            color: #333;
            overflow-x: hidden;
        }
        
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* سایدبار */
        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            z-index: 100;
        }
        
        .logo {
            text-align: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .logo h2 {
            color: #27ae60;
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .logo p {
            font-size: 0.8rem;
            color: #aaa;
            margin-top: 5px;
        }
        
        .nav-menu {
            list-style: none;
            padding: 20px 0;
        }
        
        .nav-menu li {
            margin: 5px 0;
        }
        
        .nav-menu a {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: #ddd;
            text-decoration: none;
            transition: all 0.3s;
            border-right: 3px solid transparent;
        }
        
        .nav-menu a:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .nav-menu a.active {
            background: rgba(255,255,255,0.15);
            color: white;
            border-right: 3px solid #27ae60;
        }
        
        .nav-menu i {
            width: 25px;
            text-align: center;
            margin-left: 10px;
            font-size: 1.1rem;
        }
        
        /* محتوای اصلی */
        .main-content {
            flex: 1;
            margin-right: 250px;
            padding: 20px;
            width: calc(100% - 250px);
            min-height: 100vh;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 1.5rem;
        }
        
        .btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background: #219653;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .btn-secondary {
            background: #3498db;
        }
        
        .btn-secondary:hover {
            background: #2980b9;
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        /* بخش‌های اصلی */
        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .section.active {
            display: block;
        }
        
        /* کارت‌ها */
        .card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #2c3e50;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        .form-control:focus {
            border-color: #27ae60;
            outline: none;
            box-shadow: 0 0 0 3px rgba(39, 174, 96, 0.1);
        }
        
        /* جدول‌ها */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 8px;
            border: 1px solid #eee;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        th {
            background: #2c3e50;
            color: white;
            padding: 15px;
            text-align: right;
            font-weight: 500;
            white-space: nowrap;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            vertical-align: middle;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        /* آمار */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            color: #27ae60;
            margin-bottom: 15px;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        /* تنظیمات رمز عبور */
        .password-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }
        
        .password-strength {
            height: 5px;
            margin-top: 5px;
            border-radius: 3px;
            transition: all 0.3s;
        }
        
        .weak { background: #e74c3c; width: 30%; }
        .medium { background: #f39c12; width: 60%; }
        .strong { background: #27ae60; width: 100%; }
        
        /* دکمه خروج */
        .logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            transition: background 0.3s;
        }
        
        .logout-btn:hover {
            background: #c0392b;
        }
        
        /* نوتیفیکیشن */
        .notification {
            position: fixed;
            bottom: 20px;
            left: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            max-width: 400px;
        }
        
        .notification.success {
            background: #27ae60;
            color: white;
        }
        
        .notification.error {
            background: #e74c3c;
            color: white;
        }
        
        .notification.info {
            background: #3498db;
            color: white;
        }
        
        .notification.warning {
            background: #f39c12;
            color: white;
        }
        
        /* رسپانسیو */
        @media (max-width: 992px) {
            .sidebar {
                width: 70px;
            }
            
            .logo h2,
            .nav-menu span {
                display: none;
            }
            
            .main-content {
                margin-right: 70px;
                width: calc(100% - 70px);
                padding: 15px;
            }
            
            .nav-menu a {
                padding: 15px 0;
                justify-content: center;
            }
            
            .nav-menu i {
                margin: 0;
                font-size: 1.2rem;
            }
        }
        
        @media (max-width: 768px) {
            .admin-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                padding: 10px 0;
            }
            
            .nav-menu {
                display: flex;
                justify-content: center;
                flex-wrap: wrap;
                padding: 10px;
                gap: 5px;
            }
            
            .nav-menu li {
                flex: 1;
                min-width: 60px;
            }
            
            .main-content {
                margin-right: 0;
                width: 100%;
            }
            
            .header {
                flex-direction: column;
                text-align: center;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 1.3rem;
            }
        }
        
        /* انیمیشن‌ها */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- بررسی وضعیت ورود -->
    <script>
	// ==================== مدیریت سفارشات پیشرفته ====================

let currentOrderFilter = 'all';

// فیلتر سفارشات
function filterOrders(status) {
    currentOrderFilter = status;
    
    // آپدیت دکمه‌های فیلتر
    document.querySelectorAll('.order-filters button').forEach(btn => {
        btn.classList.remove('active');
    });
    document.getElementById(`filter-${status}`).classList.add('active');
    
    // نمایش سفارشات فیلتر شده
    displayOrdersTable();
}

// نمایش جدول سفارشات
function displayOrdersTable() {
    const tbody = document.getElementById('orders-table-body');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    
    const orders = JSON.parse(localStorage.getItem('shop_orders') || '[]');
    
    // فیلتر سفارشات
    let filteredOrders = orders;
    if (currentOrderFilter !== 'all') {
        filteredOrders = orders.filter(order => {
            if (currentOrderFilter === 'pending') return order.status === 'در انتظار تأیید';
            if (currentOrderFilter === 'confirmed') return order.status === 'تأیید شده';
            if (currentOrderFilter === 'delivered') return order.status === 'تحویل شده';
            return true;
        });
    }
    
    if (filteredOrders.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="8" style="text-align: center; padding: 40px; color: #666;">
                    <i class="fas fa-shopping-cart" style="font-size: 2rem; color: #ddd; margin-bottom: 10px; display: block;"></i>
                    هیچ سفارشی ${currentOrderFilter === 'all' ? '' : 'با این وضعیت'} ثبت نشده است
                </td>
            </tr>
        `;
        return;
    }
    
    // نمایش سفارشات از جدید به قدیم
    filteredOrders.slice().reverse().forEach((order, index) => {
        const productsList = order.items ? 
            order.items.map(item => `${item.name} (${item.quantity} عدد)`).join('<br>') :
            'محصولات سفارش';
        
        // اطلاعات مشتری
        const customerName = order.customer ? order.customer.name : 'مشتری آنلاین';
        const customerPhone = order.customer ? order.customer.phone : 'نامشخص';
        
        // وضعیت سفارش
        const statusClass = getStatusClass(order.status);
        
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><strong>#${order.id || (filteredOrders.length - index)}</strong></td>
            <td style="font-size: 0.9rem;">${order.date || 'تاریخ نامشخص'}</td>
            <td>${customerName}</td>
            <td style="direction: ltr; text-align: left;">${customerPhone}</td>
            <td style="font-size: 0.9rem;">${productsList}</td>
            <td style="font-weight: bold; color: #27ae60;">${order.total ? order.total.toLocaleString('fa-IR') : '0'} افغانی</td>
            <td>
                <span class="status-badge ${statusClass}">
                    ${order.status || 'در انتظار تأیید'}
                </span>
            </td>
            <td>
                <div class="order-actions">
                    <button class="action-btn btn-view" onclick="viewOrderDetails(${order.id || index})">
                        <i class="fas fa-eye"></i>
                    </button>
                    ${order.status === 'در انتظار تأیید' ? `
                        <button class="action-btn btn-confirm" onclick="updateOrderStatus(${order.id || index}, 'تأیید شده')">
                            <i class="fas fa-check"></i>
                        </button>
                        <button class="action-btn btn-cancel" onclick="updateOrderStatus(${order.id || index}, 'لغو شده')">
                            <i class="fas fa-times"></i>
                        </button>
                    ` : ''}
                    ${order.status === 'تأیید شده' ? `
                        <button class="action-btn btn-deliver" onclick="updateOrderStatus(${order.id || index}, 'تحویل شده')">
                            <i class="fas fa-truck"></i>
                        </button>
                    ` : ''}
                </div>
            </td>
        `;
        tbody.appendChild(row);
    });
}

// کلاس وضعیت
function getStatusClass(status) {
    switch(status) {
        case 'در انتظار تأیید': return 'status-pending';
        case 'تأیید شده': return 'status-confirmed';
        case 'تحویل شده': return 'status-delivered';
        case 'لغو شده': return 'status-cancelled';
        default: return 'status-pending';
    }
}

// نمایش جزئیات سفارش
function viewOrderDetails(orderId) {
    const orders = JSON.parse(localStorage.getItem('shop_orders') || '[]');
    const order = orders.find(o => o.id == orderId || o.id === orderId);
    
    if (!order) {
        showNotification('سفارش یافت نشد!', 'error');
        return;
    }
    
    // اطلاعات مشتری
    const customer = order.customer || {
        name: 'نامشخص',
        phone: 'نامشخص',
        address: 'نامشخص',
        note: ''
    };
    
    // تولید HTML جزئیات
    let detailsHTML = `
        <div class="order-details-grid">
            <div class="detail-card">
                <h4><i class="fas fa-info-circle"></i> اطلاعات سفارش</h4>
                <div class="detail-item">
                    <span class="detail-label">شماره سفارش:</span>
                    <span class="detail-value">${order.id || 'نامشخص'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">تاریخ سفارش:</span>
                    <span class="detail-value">${order.date || 'نامشخص'}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">مبلغ کل:</span>
                    <span class="detail-value" style="color: #27ae60; font-size: 1.1rem;">${order.total ? order.total.toLocaleString('fa-IR') : '0'} افغانی</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">وضعیت:</span>
                    <span class="detail-value">
                        <span class="status-badge ${getStatusClass(order.status || 'در انتظار تأیید')}">
                            ${order.status || 'در انتظار تأیید'}
                        </span>
                    </span>
                </div>
            </div>
            
            <div class="detail-card">
                <h4><i class="fas fa-user"></i> اطلاعات مشتری</h4>
                <div class="detail-item">
                    <span class="detail-label">نام کامل:</span>
                    <span class="detail-value">${customer.name}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">شماره تماس:</span>
                    <span class="detail-value" style="direction: ltr;">${customer.phone}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">آدرس تحویل:</span>
                    <span class="detail-value">${customer.address}</span>
                </div>
                ${customer.note ? `
                <div class="detail-item">
                    <span class="detail-label">یادداشت:</span>
                    <span class="detail-value">${customer.note}</span>
                </div>
                ` : ''}
            </div>
        </div>
        
        <h4 style="color: #2c3e50; margin: 25px 0 15px;">
            <i class="fas fa-box-open"></i> محصولات سفارش
        </h4>
        
        <table class="products-table">
            <thead>
                <tr>
                    <th>ردیف</th>
                    <th>نام محصول</th>
                    <th>تعداد</th>
                    <th>قیمت واحد</th>
                    <th>جمع</th>
                </tr>
            </thead>
            <tbody>
    `;
    
    // افزودن محصولات
    if (order.items && order.items.length > 0) {
        order.items.forEach((item, index) => {
            const itemTotal = item.price * item.quantity;
            detailsHTML += `
                <tr>
                    <td>${index + 1}</td>
                    <td>${item.name}</td>
                    <td>${item.quantity} عدد</td>
                    <td>${item.price.toLocaleString('fa-IR')} افغانی</td>
                    <td style="font-weight: bold; color: #27ae60;">${itemTotal.toLocaleString('fa-IR')} افغانی</td>
                </tr>
            `;
        });
    }
    
    detailsHTML += `
            </tbody>
        </table>
        
        <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee;">
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="closeOrderDetails()">
                    <i class="fas fa-times"></i> بستن
                </button>
                ${order.status === 'در انتظار تأیید' ? `
                    <button class="btn btn-confirm" onclick="updateOrderStatusFromModal(${order.id || orderId}, 'تأیید شده')">
                        <i class="fas fa-check"></i> تأیید سفارش
                    </button>
                ` : ''}
                ${order.status === 'تأیید شده' ? `
                    <button class="btn" style="background: #9b59b6; color: white;" onclick="updateOrderStatusFromModal(${order.id || orderId}, 'تحویل شده')">
                        <i class="fas fa-truck"></i> تحویل شد
                    </button>
                ` : ''}
            </div>
        </div>
    `;
    
    // نمایش مودال
    document.getElementById('order-details-content').innerHTML = detailsHTML;
    document.getElementById('order-details-modal').style.display = 'flex';
}

// بستن جزئیات سفارش
function closeOrderDetails() {
    document.getElementById('order-details-modal').style.display = 'none';
}

// به‌روزرسانی وضعیت سفارش
function updateOrderStatus(orderId, newStatus) {
    if (!confirm(`آیا می‌خواهید وضعیت این سفارش را به "${newStatus}" تغییر دهید؟`)) {
        return;
    }
    
    const orders = JSON.parse(localStorage.getItem('shop_orders') || '[]');
    const orderIndex = orders.findIndex(o => o.id == orderId || o.id === orderId);
    
    if (orderIndex !== -1) {
        orders[orderIndex].status = newStatus;
        localStorage.setItem('shop_orders', JSON.stringify(orders));
        
        showNotification(`وضعیت سفارش به "${newStatus}" تغییر یافت`, 'success');
        displayOrdersTable();
        
        // اگر در مودال هستیم، ببندیم
        closeOrderDetails();
    }
}

// به‌روزرسانی وضعیت از داخل مودال
function updateOrderStatusFromModal(orderId, newStatus) {
    updateOrderStatus(orderId, newStatus);
}

// بارگذاری سفارشات هنگام ورود به بخش سفارشات
function loadOrdersSection() {
    displayOrdersTable();
}
        // بررسی آیا کاربر وارد شده است
        function checkAuth() {
            const loggedIn = sessionStorage.getItem('admin_logged_in');
            const loginTime = sessionStorage.getItem('login_time');
            
            if (!loggedIn || !loginTime) {
                window.location.href = 'login.html';
                return false;
            }
            
            // بررسی زمان (30 دقیقه)
            const timeDiff = Date.now() - parseInt(loginTime);
            if (timeDiff > 30 * 60 * 1000) {
                sessionStorage.clear();
                window.location.href = 'login.html';
                return false;
            }
            
            return true;
        }
        
        // بررسی اولیه
        if (!checkAuth()) {
            // ریدایرکت انجام می‌شود
        }
        
        // بررسی دوره‌ای هر 5 دقیقه
        setInterval(checkAuth, 5 * 60 * 1000);
    </script>
    
    <div class="admin-container">
        <!-- سایدبار -->
        <aside class="sidebar">
            <div class="logo">
                <h2><i class="fas fa-cogs"></i> مدیریت</h2>
                <p id="admin-name">در حال بارگذاری...</p>
            </div>
            <ul class="nav-menu">
                <li><a href="#dashboard" class="active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i> <span>داشبورد</span>
                </a></li>
                <li><a href="#products" data-section="products">
                    <i class="fas fa-box-open"></i> <span>محصولات</span>
                </a></li>
                <li><a href="#orders" data-section="orders">
                    <i class="fas fa-shopping-cart"></i> <span>سفارشات</span>
                </a></li>
                <li><a href="#settings" data-section="settings">
                    <i class="fas fa-cog"></i> <span>تنظیمات</span>
                </a></li>
                <li><a href="index.html" target="_blank">
                    <i class="fas fa-store"></i> <span>فروشگاه</span>
                </a></li>
                <li><a href="#" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> <span>خروج</span>
                </a></li>
            </ul>
        </aside>

        <!-- محتوای اصلی -->
        <main class="main-content">
            <!-- هدر -->
            <div class="header">
                <div>
                    <h1><i class="fas fa-tachometer-alt"></i> پنل مدیریت دکان آنلاین</h1>
                    <p style="color: #666; margin-top: 5px; font-size: 0.9rem;" id="current-date">
                        <!-- تاریخ نمایش داده می‌شود -->
                    </p>
                </div>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span id="welcome-message" style="color: #666; font-size: 0.9rem;"></span>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> خروج
                    </button>
                </div>
            </div>

            <!-- بخش داشبورد -->
            <div class="section active" id="dashboard-section">
                <h2 style="margin-bottom: 25px; color: #2c3e50; padding-bottom: 15px; border-bottom: 2px solid #eee;">
                    <i class="fas fa-tachometer-alt"></i> داشبورد مدیریت
                </h2>
                
                <!-- آمار کلی -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-box"></i>
                        </div>
                        <div class="stat-number" id="total-products">0</div>
                        <div class="stat-label">تعداد محصولات</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="stat-number" id="total-orders">0</div>
                        <div class="stat-label">سفارشات امروز</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-number" id="total-revenue">0</div>
                        <div class="stat-label">درآمد امروز</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-number" id="total-views">0</div>
                        <div class="stat-label">بازدید امروز</div>
                    </div>
                </div>
                
                <!-- راهنما -->
                <div class="card">
                    <h3 style="color: #2c3e50; margin-bottom: 15px;">
                        <i class="fas fa-info-circle"></i> راهنمای سریع
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div style="display: flex; align-items: flex-start; gap: 10px;">
                            <i class="fas fa-plus-circle" style="color: #27ae60; font-size: 1.2rem; margin-top: 3px;"></i>
                            <div>
                                <strong>افزودن محصول</strong>
                                <p style="color: #666; font-size: 0.9rem; margin-top: 5px;">برای افزودن محصول جدید به بخش "محصولات" بروید</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 10px;">
                            <i class="fas fa-shopping-cart" style="color: #3498db; font-size: 1.2rem; margin-top: 3px;"></i>
                            <div>
                                <strong>مدیریت سفارشات</strong>
                                <p style="color: #666; font-size: 0.9rem; margin-top: 5px;">سفارشات مشتریان در بخش "سفارشات" نمایش داده می‌شود</p>
                            </div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 10px;">
                            <i class="fas fa-key" style="color: #e74c3c; font-size: 1.2rem; margin-top: 3px;"></i>
                            <div>
                                <strong>تغییر رمز عبور</strong>
                                <p style="color: #666; font-size: 0.9rem; margin-top: 5px;">رمز عبور خود را در بخش "تنظیمات" تغییر دهید</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- بخش محصولات -->
            <div class="section" id="products-section">
                <h2 style="margin-bottom: 25px; color: #2c3e50; padding-bottom: 15px; border-bottom: 2px solid #eee;">
                    <i class="fas fa-box-open"></i> مدیریت محصولات
                </h2>
                
                <!-- فرم افزودن محصول -->
                <div class="card">
                    <h3 style="color: #2c3e50; margin-bottom: 20px;">
                        <i class="fas fa-plus-circle"></i> افزودن محصول جدید
                    </h3>
                    
                    <form id="add-product-form">
                        <div class="form-group">
                            <label for="product-name">نام محصول:</label>
                            <input type="text" id="product-name" class="form-control" placeholder="مثال: گوشی سامسونگ" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="product-description">توضیحات:</label>
                            <textarea id="product-description" class="form-control" rows="3" placeholder="توضیحات محصول..." required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="product-price">قیمت (افغانی):</label>
                            <input type="number" id="product-price" class="form-control" placeholder="مثال: 25000" min="0" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="product-category">دسته‌بندی:</label>
                            <select id="product-category" class="form-control" required>
                                <option value="">انتخاب کنید</option>
                                <option value="electronics">الکترونیکی</option>
                                <option value="clothing">پوشاک</option>
                                <option value="home">لوازم خانه</option>
                                <option value="sports">ورزشی</option>
                                <option value="food">مواد غذایی</option>
                                <option value="other">سایر</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="product-stock">موجودی:</label>
                            <input type="number" id="product-stock" class="form-control" placeholder="تعداد در انبار" min="0" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="product-image">آدرس تصویر:</label>
                            <input type="url" id="product-image" class="form-control" placeholder="https://example.com/image.jpg" required>
                            <small style="color: #666; display: block; margin-top: 5px;">
                                می‌توانید از <a href="https://unsplash.com" target="_blank" style="color: #3498db;">Unsplash.com</a> آدرس عکس بگیرید
                            </small>
                        </div>
                        
                        <div class="form-group">
                            <label for="product-badge">برچسب:</label>
                            <select id="product-badge" class="form-control">
                                <option value="">بدون برچسب</option>
                                <option value="جدید">جدید</option>
                                <option value="پرفروش">پرفروش</option>
                                <option value="تخفیف">تخفیف</option>
                                <option value="محصول محلی">محصول محلی</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button type="submit" class="btn" id="submit-product-btn">
                                <i class="fas fa-save"></i> ذخیره محصول
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearProductForm()">
                                <i class="fas fa-eraser"></i> پاک کردن فرم
                            </button>
                            <button type="button" class="btn" style="background: #9b59b6;" onclick="addSampleProduct()">
                                <i class="fas fa-magic"></i> محصول نمونه
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- لیست محصولات -->
                <div class="card">
                    <h3 style="color: #2c3e50; margin-bottom: 20px;">
                        <i class="fas fa-list"></i> لیست محصولات
                    </h3>
                    
                    <div class="table-container">
                        <table id="products-table">
                            <thead>
                                <tr>
                                    <th>شماره</th>
                                    <th>تصویر</th>
                                    <th>نام محصول</th>
                                    <th>قیمت (افغانی)</th>
                                    <th>موجودی</th>
                                    <th>دسته‌بندی</th>
                                    <th>عملیات</th>
                                </tr>
                            </thead>
                            <tbody id="products-table-body">
                                <!-- محصولات به صورت داینامیک اضافه می‌شوند -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- بخش سفارشات -->
<div class="section" id="orders-section">
    <h2 style="margin-bottom: 25px; color: #2c3e50; padding-bottom: 15px; border-bottom: 2px solid #eee;">
        <i class="fas fa-shopping-cart"></i> مدیریت سفارشات
    </h2>
    
    <!-- فیلترهای سفارشات -->
    <div class="card" style="margin-bottom: 20px;">
        <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
            <button class="btn btn-secondary" onclick="filterOrders('all')" id="filter-all">
                همه سفارشات
            </button>
            <button class="btn" style="background: #f39c12; color: white;" onclick="filterOrders('pending')" id="filter-pending">
                در انتظار تأیید
            </button>
            <button class="btn" style="background: #3498db; color: white;" onclick="filterOrders('confirmed')" id="filter-confirmed">
                تأیید شده
            </button>
            <button class="btn" style="background: #27ae60; color: white;" onclick="filterOrders('delivered')" id="filter-delivered">
                تحویل شده
            </button>
        </div>
    </div>
    
    <!-- لیست سفارشات -->
    <div class="card">
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>شماره سفارش</th>
                        <th>تاریخ</th>
                        <th>مشتری</th>
                        <th>شماره تماس</th>
                        <th>محصولات</th>
                        <th>مبلغ کل</th>
                        <th>وضعیت</th>
                        <th>عملیات</th>
                    </tr>
                </thead>
                <tbody id="orders-table-body">
                    <!-- سفارشات به صورت داینامیک اضافه می‌شوند -->
                </tbody>
            </table>
        </div>
        
        <!-- جزئیات سفارش -->
        <div id="order-details-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-file-invoice"></i> جزئیات سفارش</h3>
                    <button class="close-modal" onclick="closeOrderDetails()">×</button>
                </div>
                <div class="modal-body" id="order-details-content">
                    <!-- جزئیات سفارش نمایش داده می‌شود -->
                </div>
            </div>
        </div>
    </div>
</div>

            <!-- بخش تنظیمات -->
            <div class="section" id="settings-section">
                <h2 style="margin-bottom: 25px; color: #2c3e50; padding-bottom: 15px; border-bottom: 2px solid #eee;">
                    <i class="fas fa-cog"></i> تنظیمات سیستم
                </h2>
                
                <!-- تغییر رمز عبور -->
                <div class="card">
                    <div class="password-form">
                        <h3 style="color: #2c3e50; margin-bottom: 20px;">
                            <i class="fas fa-key"></i> تغییر رمز عبور
                        </h3>
                        
                        <div class="form-group">
                            <label for="current-password">رمز عبور فعلی:</label>
                            <input type="password" id="current-password" class="form-control" placeholder="رمز عبور فعلی را وارد کنید">
                        </div>
                        
                        <div class="form-group">
                            <label for="new-password">رمز عبور جدید:</label>
                            <input type="password" id="new-password" class="form-control" placeholder="رمز عبور جدید را وارد کنید" oninput="checkPasswordStrength()">
                            <div id="password-strength" class="password-strength"></div>
                            <small style="color: #666; display: block; margin-top: 5px;">
                                رمز عبور باید حداقل ۶ کاراکتر و شامل حروف و اعداد باشد
                            </small>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirm-password">تکرار رمز عبور جدید:</label>
                            <input type="password" id="confirm-password" class="form-control" placeholder="رمز عبور جدید را تکرار کنید">
                        </div>
                        
                        <button class="btn" onclick="changeAdminPassword()">
                            <i class="fas fa-save"></i> تغییر رمز عبور
                        </button>
                        
                        <div id="password-message" style="margin-top: 15px;"></div>
                    </div>
                    
                    <!-- اطلاعات سیستم -->
                    <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee;">
                        <h3 style="color: #2c3e50; margin-bottom: 15px;">
                            <i class="fas fa-info-circle"></i> اطلاعات سیستم
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="font-weight: bold; color: #2c3e50; font-size: 0.9rem;">نام کاربری</div>
                                <div id="current-username" style="color: #27ae60; font-weight: bold; margin-top: 5px;">admin</div>
                            </div>
                            
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="font-weight: bold; color: #2c3e50; font-size: 0.9rem;">آخرین ورود</div>
                                <div id="last-login" style="color: #666; margin-top: 5px; font-size: 0.9rem;">-</div>
                            </div>
                            
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="font-weight: bold; color: #2c3e50; font-size: 0.9rem;">نسخه سیستم</div>
                                <div style="color: #666; margin-top: 5px; font-weight: bold;">2.0.0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ==================== متغیرهای عمومی ====================
        let products = [];
        let orders = [];
        let currentEditId = null;
        
        // ==================== مدیریت منو ====================
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('پنل مدیریت در حال راه‌اندازی...');
            
            // نمایش اطلاعات کاربر
            displayUserInfo();
            
            // تنظیم تاریخ جاری
            updateCurrentDate();
            
            // رویدادهای منو
            setupMenuNavigation();
            
            // بارگذاری داده‌ها
            loadData();
            
            // تنظیم فرم محصولات
            setupProductForm();
            
            console.log('پنل مدیریت راه‌اندازی شد');
        });
        
        // نمایش اطلاعات کاربر
        function displayUserInfo() {
            const username = sessionStorage.getItem('admin_username') || 'مدیر';
            document.getElementById('admin-name').textContent = username;
            document.getElementById('current-username').textContent = username;
            document.getElementById('welcome-message').textContent = `خوش آمدید ${username}`;
            
            // تاریخ آخرین ورود
            const loginTime = sessionStorage.getItem('login_time');
            if (loginTime) {
                const date = new Date(parseInt(loginTime));
                document.getElementById('last-login').textContent = date.toLocaleString('fa-IR');
            }
        }
        
        // به‌روزرسانی تاریخ جاری
        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            };
            document.getElementById('current-date').textContent = now.toLocaleDateString('fa-IR', options);
        }
        
        // تنظیم منوی ناوبری
        function setupMenuNavigation() {
            document.querySelectorAll('.nav-menu a[data-section]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // حذف active از همه
                    document.querySelectorAll('.nav-menu a').forEach(a => {
                        a.classList.remove('active');
                    });
                    
                    // اضافه active به لینک کلیک شده
                    this.classList.add('active');
                    
                    // مخفی کردن همه بخش‌ها
                    document.querySelectorAll('.section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // نمایش بخش مورد نظر
                    const section = this.getAttribute('data-section');
                    document.getElementById(section + '-section').classList.add('active');
                    
                    // اگر بخش سفارشات است، داده‌ها را رفرش کن
                    if (section === 'orders') {
                        displayOrdersTable();
                    }
                    
                    showNotification(`بخش ${this.querySelector('span').textContent} نمایش داده شد`, 'info');
                });
            });
        }
        
        // ==================== مدیریت داده‌ها ====================
        
        function loadData() {
            // بارگذاری محصولات
            const savedProducts = localStorage.getItem('shop_products');
            if (savedProducts) {
                try {
                    products = JSON.parse(savedProducts);
                } catch (e) {
                    console.error('خطا در بارگذاری محصولات:', e);
                    products = [];
                }
            } else {
                // داده‌های اولیه
                products = [
                    {
                        id: 1,
                        name: "گوشی سامسونگ گلکسی A54",
                        description: "گوشی هوشمند با دوربین 50 مگاپیکسل و باتری 5000 میلی‌آمپر",
                        price: 24900,
                        category: "electronics",
                        stock: 15,
                        image: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400&h=300&fit=crop",
                        badge: "جدید"
                    },
                    {
                        id: 2,
                        name: "لپ‌تاپ دل اینسپایرون 15",
                        description: "پردازنده Core i7، رم 16GB، هارد SSD 512GB",
                        price: 89900,
                        category: "electronics",
                        stock: 8,
                        image: "https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop",
                        badge: "پرفروش"
                    }
                ];
                saveProducts();
            }
            
            // بارگذاری سفارشات
            const savedOrders = localStorage.getItem('shop_orders');
            orders = savedOrders ? JSON.parse(savedOrders) : [];
            
            // آپدیت آمار و نمایش
            updateStats();
            displayProductsTable();
            displayOrdersTable();
        }
        
        // ذخیره محصولات
        function saveProducts() {
            try {
                localStorage.setItem('shop_products', JSON.stringify(products));
                // برای همگام‌سازی با فروشگاه اصلی
                localStorage.setItem('shop_products_main', JSON.stringify(products));
                return true;
            } catch (e) {
                console.error('خطا در ذخیره محصولات:', e);
                showNotification('خطا در ذخیره محصولات', 'error');
                return false;
            }
        }
        
        // آپدیت آمار
        function updateStats() {
            document.getElementById('total-products').textContent = products.length;
            
            const today = new Date().toLocaleDateString('fa-IR');
            const todayOrders = orders.filter(order => order.date && order.date.includes(today));
            document.getElementById('total-orders').textContent = todayOrders.length;
            
            const todayRevenue = todayOrders.reduce((sum, order) => sum + (order.total || 0), 0);
            document.getElementById('total-revenue').textContent = todayRevenue.toLocaleString('fa-IR');
            
            // بازدیدها
            const views = parseInt(localStorage.getItem('shop_views') || Math.floor(Math.random() * 100) + 50);
            document.getElementById('total-views').textContent = views;
        }
        
        // ==================== مدیریت محصولات ====================
        
        function setupProductForm() {
            const form = document.getElementById('add-product-form');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    saveOrUpdateProduct();
                });
            }
        }
        
        function saveOrUpdateProduct() {
            const product = {
                id: currentEditId || Date.now(),
                name: document.getElementById('product-name').value.trim(),
                description: document.getElementById('product-description').value.trim(),
                price: parseInt(document.getElementById('product-price').value) || 0,
                category: document.getElementById('product-category').value,
                stock: parseInt(document.getElementById('product-stock').value) || 0,
                image: document.getElementById('product-image').value.trim(),
                badge: document.getElementById('product-badge').value || ''
            };
            
            // اعتبارسنجی
            if (!product.name || !product.description || product.price <= 0 || !product.category || product.stock < 0 || !product.image) {
                showNotification('لطفاً همه فیلدهای لازم را پر کنید', 'error');
                return;
            }
            
            if (currentEditId) {
                // ویرایش محصول موجود
                const index = products.findIndex(p => p.id === currentEditId);
                if (index !== -1) {
                    products[index] = product;
                }
                currentEditId = null;
                document.getElementById('submit-product-btn').innerHTML = '<i class="fas fa-save"></i> ذخیره محصول';
                showNotification('محصول با موفقیت ویرایش شد', 'success');
            } else {
                // افزودن محصول جدید
                products.push(product);
                showNotification('محصول با موفقیت اضافه شد', 'success');
            }
            
            if (saveProducts()) {
                updateStats();
                displayProductsTable();
                clearProductForm();
            }
        }
        
        function displayProductsTable() {
            const tbody = document.getElementById('products-table-body');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (products.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-box-open" style="font-size: 2rem; color: #ddd; margin-bottom: 10px; display: block;"></i>
                            هیچ محصولی وجود ندارد
                        </td>
                    </tr>
                `;
                return;
            }
            
            products.forEach((product, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>
                        <img src="${product.image}" alt="${product.name}" 
                             style="width: 60px; height: 60px; object-fit: cover; border-radius: 6px;"
                             onerror="this.src='https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=100&h=100&fit=crop'">
                    </td>
                    <td>
                        <div style="font-weight: bold; margin-bottom: 5px;">${product.name}</div>
                        <div style="color: #666; font-size: 0.85rem;">${product.description.substring(0, 50)}...</div>
                        ${product.badge ? `<div style="margin-top: 5px;"><span style="background: #e74c3c; color: white; padding: 3px 10px; border-radius: 12px; font-size: 0.75rem;">${product.badge}</span></div>` : ''}
                    </td>
                    <td style="font-weight: bold; color: #27ae60;">${product.price.toLocaleString('fa-IR')}</td>
                    <td>
                        <span style="color: ${product.stock > 10 ? '#27ae60' : product.stock > 0 ? '#f39c12' : '#e74c3c'}; font-weight: bold;">
                            ${product.stock} عدد
                        </span>
                    </td>
                    <td>
                        <span style="background: #f1f2f6; padding: 5px 12px; border-radius: 15px; font-size: 0.85rem;">
                            ${getCategoryName(product.category)}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-secondary" onclick="editProduct(${product.id})" style="padding: 8px 12px; font-size: 0.85rem;">
                                <i class="fas fa-edit"></i> ویرایش
                            </button>
                            <button class="btn btn-danger" onclick="deleteProduct(${product.id})" style="padding: 8px 12px; font-size: 0.85rem;">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function getCategoryName(category) {
            const categories = {
                'electronics': 'الکترونیکی',
                'clothing': 'پوشاک',
                'home': 'لوازم خانه',
                'sports': 'ورزشی',
                'food': 'مواد غذایی',
                'other': 'سایر'
            };
            return categories[category] || category;
        }
        
        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;
            
            currentEditId = id;
            
            document.getElementById('product-name').value = product.name;
            document.getElementById('product-description').value = product.description;
            document.getElementById('product-price').value = product.price;
            document.getElementById('product-category').value = product.category;
            document.getElementById('product-stock').value = product.stock;
            document.getElementById('product-image').value = product.image;
            document.getElementById('product-badge').value = product.badge;
            
            // تغییر متن دکمه
            document.getElementById('submit-product-btn').innerHTML = '<i class="fas fa-save"></i> ویرایش محصول';
            
            // اسکرول به بخش محصولات
            document.querySelector('a[data-section="products"]').click();
            
            showNotification('در حال ویرایش محصول...', 'info');
        }
        
        function deleteProduct(id) {
            if (!confirm('آیا از حذف این محصول اطمینان دارید؟')) return;
            
            products = products.filter(p => p.id !== id);
            if (saveProducts()) {
                updateStats();
                displayProductsTable();
                showNotification('محصول با موفقیت حذف شد', 'success');
            }
        }
        
        function clearProductForm() {
            document.getElementById('add-product-form').reset();
            currentEditId = null;
            document.getElementById('submit-product-btn').innerHTML = '<i class="fas fa-save"></i> ذخیره محصول';
            document.getElementById('password-strength').className = 'password-strength';
            document.getElementById('password-strength').style.width = '0';
        }
        
        function addSampleProduct() {
            const sampleProducts = [
                {
                    name: "هدفون بی‌سیم",
                    description: "کیفیت صدای عالی، باتری 20 ساعته",
                    price: 8500,
                    category: "electronics",
                    stock: 25,
                    image: "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400&h=300&fit=crop",
                    badge: "جدید"
                }
            ];
            
            const randomProduct = sampleProducts[0];
            
            document.getElementById('product-name').value = randomProduct.name;
            document.getElementById('product-description').value = randomProduct.description;
            document.getElementById('product-price').value = randomProduct.price;
            document.getElementById('product-category').value = randomProduct.category;
            document.getElementById('product-stock').value = randomProduct.stock;
            document.getElementById('product-image').value = randomProduct.image;
            document.getElementById('product-badge').value = randomProduct.badge;
            
            showNotification('یک محصول نمونه وارد شد', 'info');
        }
        
        // ==================== مدیریت سفارشات ====================
        
        function displayOrdersTable() {
            const tbody = document.getElementById('orders-table-body');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (orders.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-shopping-cart" style="font-size: 2rem; color: #ddd; margin-bottom: 10px; display: block;"></i>
                            هیچ سفارشی ثبت نشده است
                        </td>
                    </tr>
                `;
                return;
            }
            
            // نمایش سفارشات از جدید به قدیم
            orders.slice().reverse().forEach((order, index) => {
                const productsList = order.items ? 
                    order.items.map(item => `${item.name} (${item.quantity} عدد)`).join('<br>') :
                    'محصولات سفارش';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.id || (orders.length - index)}</td>
                    <td style="font-size: 0.9rem;">${order.date || 'تاریخ نامشخص'}</td>
                    <td>مشتری آنلاین</td>
                    <td style="font-size: 0.9rem;">${productsList}</td>
                    <td style="font-weight: bold; color: #27ae60;">${order.total ? order.total.toLocaleString('fa-IR') : '0'}</td>
                    <td>
                        <span style="background: #27ae60; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.85rem;">
                            ${order.status || 'پرداخت شده'}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-secondary" onclick="viewOrder(${order.id || index})" style="padding: 8px 12px; font-size: 0.85rem;">
                            <i class="fas fa-eye"></i> مشاهده
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function viewOrder(orderId) {
            const order = orders.find(o => o.id == orderId || o.id === orderId);
            
            if (!order) {
                alert('سفارش یافت نشد!');
                return;
            }
            
            let details = `📦 <strong>جزئیات سفارش</strong>\n`;
            details += `━━━━━━━━━━━━━━━━━━━━━━\n`;
            details += `🔢 شماره سفارش: ${order.id || 'نامشخص'}\n`;
            details += `📅 تاریخ: ${order.date || 'نامشخص'}\n`;
            details += `💰 مبلغ کل: <strong>${order.total ? order.total.toLocaleString('fa-IR') : '0'} افغانی</strong>\n`;
            details += `📊 وضعیت: ${order.status || 'پرداخت شده'}\n\n`;
            
            if (order.items && order.items.length > 0) {
                details += `🛍️ <strong>محصولات سفارش:</strong>\n`;
                order.items.forEach((item, index) => {
                    details += `${index + 1}. ${item.name}\n`;
                    details += `   └ تعداد: ${item.quantity} عدد\n`;
                    details += `   └ قیمت واحد: ${item.price.toLocaleString('fa-IR')} افغانی\n`;
                    details += `   └ جمع: ${(item.price * item.quantity).toLocaleString('fa-IR')} افغانی\n\n`;
                });
            }
            
            details += `━━━━━━━━━━━━━━━━━━━━━━\n`;
            details += `✅ سفارش با موفقیت ثبت شده است`;
            
            alert(details);
        }
        
        // ==================== سیستم امنیتی ====================
        
        function checkPasswordStrength() {
            const password = document.getElementById('new-password').value;
            const strengthBar = document.getElementById('password-strength');
            
            if (password.length === 0) {
                strengthBar.className = 'password-strength';
                strengthBar.style.width = '0';
                return;
            }
            
            let strength = 0;
            if (password.length >= 6) strength += 1;
            if (/[A-Za-z]/.test(password)) strength += 1;
            if (/[0-9]/.test(password)) strength += 1;
            if (/[^A-Za-z0-9]/.test(password)) strength += 1;
            
            if (password.length < 6) {
                strengthBar.className = 'password-strength weak';
            } else if (strength <= 2) {
                strengthBar.className = 'password-strength weak';
            } else if (strength === 3) {
                strengthBar.className = 'password-strength medium';
            } else {
                strengthBar.className = 'password-strength strong';
            }
        }
        
        function changeAdminPassword() {
            const currentPass = document.getElementById('current-password').value;
            const newPass = document.getElementById('new-password').value;
            const confirmPass = document.getElementById('confirm-password').value;
            const messageDiv = document.getElementById('password-message');
            
            // اعتبارسنجی
            if (!currentPass || !newPass || !confirmPass) {
                messageDiv.innerHTML = '<div style="color: #e74c3c; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 6px; border-right: 3px solid #e74c3c;"><i class="fas fa-exclamation-circle"></i> لطفاً تمام فیلدها را پر کنید</div>';
                return;
            }
            
            if (newPass.length < 6) {
                messageDiv.innerHTML = '<div style="color: #e74c3c; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 6px; border-right: 3px solid #e74c3c;"><i class="fas fa-exclamation-circle"></i> رمز عبور باید حداقل ۶ کاراکتر باشد</div>';
                return;
            }
            
            if (newPass !== confirmPass) {
                messageDiv.innerHTML = '<div style="color: #e74c3c; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 6px; border-right: 3px solid #e74c3c;"><i class="fas fa-exclamation-circle"></i> رمز عبور جدید و تکرار آن مطابقت ندارند</div>';
                return;
            }
            
            // تغییر رمز عبور در localStorage
            const storedPassword = localStorage.getItem('admin_password') || '123456';
            
            if (currentPass !== storedPassword) {
                messageDiv.innerHTML = '<div style="color: #e74c3c; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 6px; border-right: 3px solid #e74c3c;"><i class="fas fa-exclamation-circle"></i> رمز عبور فعلی نادرست است</div>';
                return;
            }
            
            // ذخیره رمز جدید
            localStorage.setItem('admin_password', newPass);
            
            messageDiv.innerHTML = `
                <div style="color: #27ae60; padding: 10px; background: rgba(39, 174, 96, 0.1); border-radius: 6px; border-right: 3px solid #27ae60;">
                    <i class="fas fa-check-circle"></i> رمز عبور با موفقیت تغییر یافت
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-right: 4px solid #3498db;">
                    <strong><i class="fas fa-info-circle"></i> نکته مهم:</strong>
                    <p style="color: #666; margin-top: 8px; font-size: 0.9rem;">
                        این رمز فقط در این مرورگر ذخیره می‌شود.<br>
                        برای استفاده در سایر دستگاه‌ها یا مرورگرها، باید همین رمز را وارد کنید.
                    </p>
                    <div style="margin-top: 10px; padding: 10px; background: white; border-radius: 6px; border: 1px dashed #ddd;">
                        <strong>رمز جدید:</strong> <code style="background: #eee; padding: 2px 6px; border-radius: 3px; font-family: monospace;">${newPass}</code>
                    </div>
                </div>
            `;
            
            // پاک کردن فرم
            document.getElementById('current-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
            document.getElementById('password-strength').className = 'password-strength';
            document.getElementById('password-strength').style.width = '0';
            
            showNotification('رمز عبور با موفقیت به‌روزرسانی شد', 'success');
        }
        
        function logout() {
            if (confirm('آیا می‌خواهید از پنل مدیریت خارج شوید؟')) {
                sessionStorage.clear();
                window.location.href = 'login.html';
            }
        }
        
        // ==================== نوتیفیکیشن ====================
        
        function showNotification(message, type = 'success') {
            // حذف نوتیفیکیشن‌های قبلی
            document.querySelectorAll('.notification').forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>

